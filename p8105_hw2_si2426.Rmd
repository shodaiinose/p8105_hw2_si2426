---
title: "p8105_hw2_si2426"
output: github_document
date: "2022-09-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
library(stringr)
library(lubridate)
```

## Problem 1

```{r loading_data, echo = FALSE}
transit_df = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% janitor::clean_names() %>% select(line, station_name, station_latitude, station_longitude, route1:route11, entrance_type, entry, vending, ada) %>% mutate(entry = recode(entry, "YES" = TRUE, NO = FALSE))
```

```{r}
head(transit_df, 5)
```

#WRITE SUMMARY PARGRAPH
There are `r nrow(distinct(transit_df %>% group_by(line, station_name)))` distinct stations. `r nrow(transit_df %>% filter(ada == TRUE))` of the stations are ADA compliant. The proportion of entrances/exits without vending that allow entrance is `r round(nrow(transit_df %>% filter (vending == "NO", entry == TRUE))/nrow(transit_df %>% filter (vending == "NO")), 2)`.

```{r data_reformat, include = FALSE}
transit_df_reformat = transit_df %>% mutate(route8 = as.character(route8), route9 = as.character(route9), route10 = as.character(route10), route11 = as.character(route11)) %>% pivot_longer(route1:route11, names_to = "route_number", values_to = "route_name")
```

There are `r nrow(transit_df_reformat %>% filter(route_name == "A") %>% distinct(line, station_name))` distinct stations that serve the A train. Of the stations that serve the A train, `r nrow(transit_df_reformat %>% filter(route_name == "A", ada == "TRUE") %>% distinct(line, station_name))` are ADA compliant.


## Problem 2

```{r}
mr_trash_df = read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Mr. Trash Wheel", range = cell_cols(c("A:N"))) %>% janitor::clean_names() %>% na.exclude(dumpster) %>% mutate(sports_balls = as.integer(round(sports_balls))) %>% mutate(dumpster = as.numeric(dumpster)) %>% mutate(type = "mr")

prof_trash_df = read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Professor Trash Wheel", range = cell_cols(c("A:N"))) %>% janitor::clean_names() %>% filter(!is.na(dumpster)) %>% mutate(sports_balls = as.integer(round(sports_balls))) %>% mutate(type = "professor")

bind_rows(mr_trash_df, prof_trash_df)
```
# COMBINE AND WRITE PARAGRAPH

## Problem 3
```{r}
pols_month_df = read_csv("./data/fivethirtyeight_datasets/pols-month.csv") %>% separate(col = mon, into= c("year", "month", "day")) %>%mutate(month = factor(month.name[(as.numeric(month))], levels = month.name)) %>% mutate(year = as.numeric(year)) %>% mutate(president = ifelse(prez_dem == 1, "dem", "gop")) %>% select(-c(prez_dem, prez_gop, day)) %>% arrange(year, month)

snp_df = read_csv("./data/fivethirtyeight_datasets/snp.csv") %>% mutate(date = as.Date(date, format = "%m/%d/%y")) %>% separate(col = date, into = c("year", "month", "day")) %>% mutate(month = factor(month.name[(as.numeric(month))], levels = month.name)) %>% mutate(year = as.numeric(year)) %>% select(-c(day)) %>% arrange(year, month)

unemployment_df = read_csv("./data/fivethirtyeight_datasets/unemployment.csv") %>% janitor::clean_names() %>% pivot_longer(jan:dec, names_to = "month", values_to = "unemployment_rate") %>% mutate(month = str_to_sentence(month)) %>% mutate(month = factor(month, levels = month.abb, labels = month.name))

left_join(pols_month_df, snp_df) %>% left_join(unemployment_df)
```







